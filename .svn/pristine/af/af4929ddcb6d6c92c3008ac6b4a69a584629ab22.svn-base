package com.thinkive.fxc.ismp.bus.base.business.dao.impl;

import java.util.List;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.business.constants.BusinessConstants;
import com.thinkive.fxc.ismp.bus.base.business.dao.BusinessLableDao;
import com.thinkive.fxc.ismp.bus.base.business.vo.BusinessTypeInfoVo;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.util.ModelUtil;

/**
 * @描述: 业务标签和类型视图数据层实现类
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 田源
 * @版本: 2.0.0 
 * @创建时间: 2016年9月16日 下午1:02:40
 */
public class BusinessLableDaoImpl extends ISMPBaseDao implements BusinessLableDao
{

    @Override
    @SuppressWarnings("unchecked")
    public List<BusinessTypeInfoVo> queryByType(String type)
    {
        StringBuilder sql = new StringBuilder();
        sql.append(" SELECT BD.BTYPE_NAME,BT.ID BTID,BT.TYPE_CODE,BT.TYPE_NAME,BT.SORT BTSORT,BI.IMG_URL,");
        sql.append(" BI.HBUSINESS_URL,BI.CONDITIONS,BI.IS_HOT,BI.ID BIID,BI.BUSINESS_CODE,");
        sql.append(" BI.BUSINESS_NAME,BI.DESCRIPTION,BI.BUSINESS_URL,BI.STATE,BI.MBUSINESS_URL,");
        sql.append(" BI.MIMG_URL,BI.MSTATE,BI.MDESCRIPTION,BI.MCONDITIONS,BAT.SORT BATSORT,BI.HIMG_URL ");
        sql.append(" FROM T_ISMP_BUSINESS_TYPE BT");
        sql.append(" LEFT JOIN T_ISMP_BUSINESSANDTYPE BAT ON BAT.TYPE_CODE = BT.TYPE_CODE");
        sql.append(" LEFT JOIN T_ISMP_BUSINESS_INFO BI ON BI.BUSINESS_CODE = BAT.BUSINESS_CODE");
        sql.append(" LEFT JOIN T_ISMP_BUSITYPE_DEFINE BD ON BD.BUSINESS_CODE = BI.BUSINESS_CODE");
        //业务支持办理的渠道类型:0：pc/web，1：H5客户端,2:手机端
        if(BusinessConstants.OP_SOURCE_PC.equals(type) ){
            sql.append(" WHERE BI.STATE = '1' ");   
        }else if(BusinessConstants.OP_SOURCE_H5.equals(type) ){
            sql.append(" WHERE BI.HSTATE = '1' ");   
        }else{
            sql.append(" WHERE BI.MSTATE = '1' ");  
        }
        sql.append(" ORDER BY BT.SORT,BAT.SORT");
        List<DataRow>  queryResult=this.getJdbcTemplate().query(sql.toString());
        return ModelUtil.packList(queryResult, BusinessTypeInfoVo.class);
    }
    
}
