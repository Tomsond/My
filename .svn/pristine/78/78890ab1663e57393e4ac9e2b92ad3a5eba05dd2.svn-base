package com.thinkive.fxc.ismp.bus.business.kc.dao.impl;

import java.util.Date;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.base.jdbc.session.Session;
import com.thinkive.fxc.ismp.bus.base.business.constants.BusinessTableConstants;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.business.kc.dao.KCEditionReservationDao;
import com.thinkive.fxc.ismp.bus.business.kc.model.KCEditionReservationModel;
import com.thinkive.server.InvokeException;

public class KCEditionReservationDaoImpl extends ISMPBaseDao implements KCEditionReservationDao{

	@SuppressWarnings("deprecation")
	@Override
	public void InsertKCEditionReservation(KCEditionReservationModel model, Session session)
			throws Exception {
		try {
			model.setUpdateDate(new Date());
			int nub =session.update(BusinessTableConstants.T_ISMP_KC_EDITION_RESERVATION, model, new String[]{"name","phone_number"}, new Object[]{model.getName(),model.getPhoneNumber()});
			if(nub==0){
				model.setId(Long.valueOf(this.getSeqValue(BusinessTableConstants.T_ISMP_KC_EDITION_RESERVATION)));
				model.setCreateDate(new Date());
				model.setUpdateDate(new Date());
				session.insert(BusinessTableConstants.T_ISMP_KC_EDITION_RESERVATION, model);	
			}	
		} catch (Exception e) {
			throw new  InvokeException(-100001, e.getMessage());
		}
	}
   
	/**
	 * 查询科创版权限开通预约信息
	 * @param cancelaccountmodel
	 * @throws Exception
	 */
	public DataRow queryKCEditionReservation(KCEditionReservationModel model)throws Exception{
		String sql ="SELECT * FROM T_ISMP_KC_EDITION_RESERVATION KC WHERE KC.NAME=? AND KC.PHONE_NUMBER=?";
		return this.getJdbcTemplate().queryMap(sql, new Object[]{model.getName(),model.getPhoneNumber()});
	}
}
