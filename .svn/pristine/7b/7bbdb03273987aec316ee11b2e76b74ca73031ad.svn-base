package com.thinkive.fxc.ismp.bus.base.basicdata.dao.impl;

import java.util.Date;
import java.util.List;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.base.util.DateHelper;
import com.thinkive.fxc.ismp.bus.base.basicdata.contants.BaseTableConstants;
import com.thinkive.fxc.ismp.bus.base.basicdata.dao.ServicetimeDao;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.ServicetimeModel;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.util.ModelUtil;

/**
 * @描述: 公共-服务时间表(T_FXC_SERVICETIME)数据层接口实现类
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 刘恺
 * @版本: 2.0.0 
 * @创建时间: 2016年8月19日 下午1:41:07
 */
public class ServicetimeDaoImpl extends ISMPBaseDao implements ServicetimeDao
{
	
	@SuppressWarnings("unchecked")
	@Override
	public List<ServicetimeModel> queryByServiceType(String serviceType)
	{
		StringBuilder sql = new StringBuilder();
		sql.append("SELECT ID, SERVICE_TYPE, START_TIME, END_TIME, CREATE_DATE, CREATE_BY, UPDATE_DATE, UPDATE_BY");
		sql.append(" FROM ").append(BaseTableConstants.T_FXC_SERVICETIME).append(" WHERE SERVICE_TYPE = ? ");
		List<DataRow> queryResult = this.getJdbcTemplate().query(sql.toString(), new Object[] { serviceType });
		return ModelUtil.packList(queryResult, ServicetimeModel.class);
	}
	
	public DataRow getTradeTime() throws Exception {
		@SuppressWarnings("unchecked")
		List<DataRow> list = this.getJdbcTemplate().query("select item_name,item_value from t_plat_enum_value where enum_no='trade_time'");
		if(list==null||list.size()<=0){
			//logger.error("未获取到交易时间设置(请在后台数据字典中配置)");
			throw new Exception("未获取到交易时间设置(请在后台数据字典中配置)");
		}
		
		DataRow data = new DataRow();
		for(int i=0;i<list.size();i++){
		data.set(list.get(i).getString("item_name"), list.get(i).getString("item_value"));
		}
		return data ;
	}
}
