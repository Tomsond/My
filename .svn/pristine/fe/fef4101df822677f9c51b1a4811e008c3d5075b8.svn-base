package com.thinkive.fxc.ismp.bus.base.basicdata.dao.impl;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.apache.commons.lang.StringUtils;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.basicdata.contants.BaseTableConstants;
import com.thinkive.fxc.ismp.bus.base.basicdata.dao.ProvinceDao;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.ProvinceModel;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.constants.SystemConstants;
import com.thinkive.fxc.ismp.bus.base.util.ModelUtil;

/**
 * @描述: 公共-省份信息表(T_FXC_PROVINCE)数据层接口实现类
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 田源
 * @版本: 2.0.0 
 * @创建时间: 2016年8月18日 下午2:44:39
 */
public class ProvinceDaoImpl extends ISMPBaseDao implements ProvinceDao
{

    @Override
    public ProvinceModel add(ProvinceModel provinceModel) throws Exception
    {
        String id=getSeqValue(SystemConstants.DB_ISMP,BaseTableConstants.T_FXC_PROVINCE);
        provinceModel.setId(Long.valueOf(id));
        provinceModel.setCreateDate(new Date());
        this.getJdbcTemplate().insert(BaseTableConstants.T_FXC_PROVINCE, provinceModel);
        return provinceModel;
    }

    @Override
    public int update(ProvinceModel provinceModel) throws Exception
    {
        provinceModel.setUpdateDate(new Date());
        return this.getJdbcTemplate().update(BaseTableConstants.T_FXC_PROVINCE, provinceModel, "ID", new Object[]{provinceModel.getId()});
    }

    @Override
    public ProvinceModel queryById(Long id) throws Exception
    {
        StringBuilder sql=new StringBuilder();
        sql.append("SELECT ID,REGION_ID,PROVINCE_NAME,ORDER_NUM,IS_DISPLAY FROM ");
        sql.append(BaseTableConstants.T_FXC_PROVINCE);
        sql.append(" WHERE ID = ?");
        DataRow queryResult=this.getJdbcTemplate().queryMap(sql.toString(),new Object[]{id});
        return ModelUtil.packInfo(queryResult, ProvinceModel.class);
    }

    @Override
    @SuppressWarnings("unchecked")
    public List<ProvinceModel> queryByParams(ProvinceModel provinceModel) throws Exception
    {
        StringBuilder sql=new StringBuilder();
        List<String> paramsList=new ArrayList<String>();
        sql.append("SELECT ID,REGION_ID,PROVINCE_NAME,ORDER_NUM,IS_DISPLAY FROM ");
        sql.append(BaseTableConstants.T_FXC_PROVINCE);
        sql.append(" WHERE 1 = 1");
        if(null != provinceModel.getRegionId()){
            sql.append(" AND REGION_ID = ?");
            paramsList.add(provinceModel.getRegionId().toString());
        }
        if(StringUtils.isNotBlank(provinceModel.getProvinceName())){
            sql.append(" AND PROVINCE_NAME = ?");
            paramsList.add(provinceModel.getProvinceName());
        }
        if(null != provinceModel.getIsDisplay()){
            sql.append(" AND IS_DISPLAY = ?");
            paramsList.add(provinceModel.getIsDisplay().toString());
        }
        List<DataRow> dataList=this.getJdbcTemplate().query(sql.toString(), paramsList.toArray());
        return ModelUtil.packList(dataList, ProvinceModel.class);
    }
    
}
