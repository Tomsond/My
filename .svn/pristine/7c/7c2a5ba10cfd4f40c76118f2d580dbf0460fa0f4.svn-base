package com.thinkive.fxc.ismp.bus.base.basicdata.service;

import java.util.List;
import java.util.Map;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.SurveyDefineModel;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.SurveySubjectModel;
import com.thinkive.fxc.ismp.bus.base.basicdata.vo.QuestionInfoVo;
import com.thinkive.fxc.ismp.bus.base.business.vo.UserInfoVo;

/**
 * @描述: 公共-问卷服务层接口
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 田源
 * @版本: 2.0.0 
 * @创建时间: 2016年8月22日 上午10:17:00
 */
public interface SurveyService
{
	
	/**
	 * @描述：根据问卷主题编号查询该主题写下所有问题和答案
	 * @作者：田源
	 * @时间：2016年8月22日 下午1:49:25
	 * @param subjectCode
	 * @return List<QuestionInfoVo>
	 * @throws Exception
	 */
	public List<QuestionInfoVo> queryBySubjectCode(String subjectCode);
	
	/**
	 * @描述：根据业务实例ID和节点ID，查询该套问卷和用户在这个业务实例下所选的答案(两个参数都必传，否则返回null)
	 * @作者：田源
	 * @时间：2016年8月30日 下午3:41:18
	 * @param businessId
	 * @param nodeId
	 * @return List<QuestionInfoVo> 
	 */
	public List<QuestionInfoVo> queryByBusinessIdAndNodeId(Long businessId, String nodeId);
	
	/**
	 * @描述：根据问卷主题编号SubjectId,分数score和状态state查询测评问卷等级,分数等级定义(三个参数都必传,否则返回null)
	 * @作者：田源
	 * @时间：2016年8月19日 下午1:33:49
	 * @param SubjectId
	 * @param state(0:无效;1:有效)
	 * @param score
	 * @return SurveyDefineModel
	 * @throws Exception
	 */
	public SurveyDefineModel queryBySubjectIdAndScore(Long SubjectId, Long score, String state) throws Exception;
	
	/**
	 * @描述：根据本地数据库问卷答案，计算用户提交的问卷分数、等级等数据
	 * @作者：刘恺
	 * @时间：2016年8月29日 上午1:05:32
	 * @param answers
	 * @param subjectCode
	 * @return
	 */
	public Map<String, Object> countUserAnswersByLocalSource(String answers, String subjectCode);
	
	/**
	 * @描述：根据问卷主题编号查询问卷主题信息
	 * @作者：田源
	 * @时间：2016年9月20日 下午5:54:40
	 * @param subjectCode
	 * @return SurveySubjectModel
	 */
	public SurveySubjectModel queryBySubject(String subjectCode);
	
	
	/**
	 * 风险测评通过校验
	 * @param sitename
	 * @param passSitename
	 * @return
	 */
	public String checkPassRisk(String subitemname, String passSitename);
	
	/**
	 * 校验风险测评是否通过（需要查询本地通过配置）
	 * @param sitename
	 * @param nodeId
	 * @return
	 */
	public String checkPassRiskNeedQurLocal(String subitemname, String nodeId, String passField);
	
	/**
	 * 校验知识测评是否通过
	 * @param knowValue
	 * @param passValue
	 * @return
	 */
	public String checkPassKnow(String knowValue, String passValue);
	
	/**
	 * 校验知识测评是否通过(需要查询本地通过配置)
	 * @param nodeId
	 * @return
	 */
	public String checkPassKnowNeedQurLocal(String knowValue, String nodeId, String passField);
	
	/**
	 * 获取三方题库信息
	 * @return
	 */
	public DataRow getThirdSurveyInfo(String sub_id, UserInfoVo userInfoVo) throws Exception ;
	
	/**
	 * 获取三方题库信息
	 * @param sub_id
	 * @param user_id
	 * @return
	 */
	public DataRow getThirdSurveyInfo(String sub_id, Long user_id) throws Exception ;
}
