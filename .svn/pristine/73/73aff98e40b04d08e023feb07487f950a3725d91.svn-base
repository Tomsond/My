package com.thinkive.fxc.ismp.bus.base.basicdata.dao.impl;

import java.util.Date;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.basicdata.contants.BaseTableConstants;
import com.thinkive.fxc.ismp.bus.base.basicdata.dao.RegionDao;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.RegionModel;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.constants.SystemConstants;
import com.thinkive.fxc.ismp.bus.base.util.ModelUtil;

/**
 * @描述: 公共-区域信息表 (T_FXC_REGION)数据层接口实现类
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 田源
 * @版本: 2.0.0 
 * @创建时间: 2016年8月18日 下午4:20:16
 */
public class RegionDaoImpl extends ISMPBaseDao implements RegionDao
{

    @Override
    public RegionModel add(RegionModel regionModel) throws Exception
    {
        String id=getSeqValue(SystemConstants.DB_ISMP,BaseTableConstants.T_FXC_REGION);
        regionModel.setId(Long.valueOf(id));
        regionModel.setCreateDate(new Date());
        this.getJdbcTemplate().insert(BaseTableConstants.T_FXC_REGION, regionModel);
        return regionModel;
    }

    @Override
    public int update(RegionModel regionModel) throws Exception
    {
        regionModel.setUpdateDate(new Date());
        return this.getJdbcTemplate().update(BaseTableConstants.T_FXC_REGION, regionModel, "ID", regionModel.getId());
    }

    @Override
    public RegionModel queryById(Long id) throws Exception
    {
        StringBuilder sql=new StringBuilder();
        sql.append("SELECT ID,REGION_NAME,ORDER_NUM,IS_DISPLAY FROM ");
        sql.append(BaseTableConstants.T_FXC_REGION);
        sql.append(" WHERE ID = ?");
        DataRow qeuryResult=this.getJdbcTemplate().queryMap(sql.toString(), new Object[]{id});
        return ModelUtil.packInfo(qeuryResult, RegionModel.class);
    }
    
}
