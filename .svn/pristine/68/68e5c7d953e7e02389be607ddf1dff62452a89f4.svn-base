package com.thinkive.fxc.ismp.bus.base.basicdata.dao.impl;

import java.util.ArrayList;
import java.util.List;







import com.thinkive.base.jdbc.DataRow;
import com.thinkive.base.util.StringHelper;
import com.thinkive.fxc.ismp.bus.base.basicdata.dao.ProvinceCityDao;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;



/**
 * 作者：MIKE
 * 公司：深圳市思迪信息技术股份公司
 * 日期时间：2017年1月6日 下午12:22:01
 * 说明：省份、城市数据查询服务实现类
 */
public class ProvinceCityDaoImpl extends ISMPBaseDao implements ProvinceCityDao
{
	/**
	 * 作者：MIKE
	 * 公司：深圳市思迪信息技术股份公司
	 * 日期时间：2017年1月6日 下午12:36:06
	 * 说明：获取省份数据集合
	 */
	@SuppressWarnings("unchecked")
	@Override
	public List<DataRow> getProvinceList() throws Exception {
		    String sql = "SELECT PROVINCE.PROVINCE_ID,PROVINCE.REGION_ID,PROVINCE.PROVINCE_NAME FROM T_PUB_PROVINCE PROVINCE WHERE PROVINCE.STATE=1 ";
	        return  this.getJdbcTemplateWork().query(sql);
	}

	/**
	 * 作者：MIKE
	 * 公司：深圳市思迪信息技术股份公司
	 * 日期时间：2017年1月6日 下午12:36:57
	 * 说明：获取城市数据集合
	 */
	@SuppressWarnings("unchecked")
	@Override
	public List<DataRow> getCityList(String province_no) throws Exception {
		StringBuffer buffer = new StringBuffer();
		List<String> args = new ArrayList<String>();
		buffer.append("SELECT CITY.CITY_ID,CITY.CITY_NAME,CITY.REGION_ID,CITY.PROVINCE_ID FROM T_PUB_CITY CITY WHERE CITY.STATE=1 ");
		if(StringHelper.isNotEmpty(province_no)){
		 buffer.append(" AND CITY.PROVINCE_NO=? ");
		 args.add(province_no);
		}
		return this.getJdbcTemplateWork().query(buffer.toString(),args.toArray());
	}

    
	/**
	 * 作者：MIKE
	 * 公司：深圳市思迪信息技术股份公司
	 * 日期时间：2017年1月6日 下午12:36:57
	 * 说明：根据区域编号查询区域下城市数据信息
	 */
	@SuppressWarnings("unchecked")
	@Override
	public List<DataRow> getPostList(String city_no) throws Exception {
		StringBuffer buffer = new StringBuffer();
		List<String> args = new ArrayList<String>();
		DataRow data = new DataRow();
		buffer.append("SELECT CITY.REGION_ID,CITY.PROVINCE_ID,CITY.CITY_ID,CITY.CITY_NAME FROM T_PUB_CITY CITY WHERE CITY.STATE=1 ");
		if(StringHelper.isNotEmpty(city_no)){
		 buffer.append(" AND CITY.REGION_ID=? ");
		 args.add(city_no);
		}
	  return this.getJdbcTemplateWork().query(buffer.toString(),args.toArray());
	}
	
	
	/**
	 * 作者：MIKE
	 * 公司：深圳市思迪信息技术股份公司
	 * 日期时间：2017年12月19日 下午3:01:25
	 * 说明： 根据区域编号查询区域下省份数据信息
	 */
	@Override
	public List<DataRow> getRegionIdList(String regional_id) throws Exception {
		StringBuffer buffer = new StringBuffer();
		List<String> args = new ArrayList<String>();
		DataRow data = new DataRow();
		buffer.append("SELECT PROVINCE.REGION_ID,PROVINCE.PROVINCE_ID,PROVINCE.PROVINCE_NAME FROM T_PUB_PROVINCE PROVINCE WHERE PROVINCE.STATE=1  ");
		if(StringHelper.isNotEmpty(regional_id)){
		 buffer.append(" AND PROVINCE.REGION_ID=? ");
		 args.add(regional_id);
		}
	  return this.getJdbcTemplateWork().query(buffer.toString(),args.toArray());
	}
	/**
	 * 说明： 根据手机号查询渠道信息
	 */
	@Override
	public DataRow getChannel(String mobile_no) throws Exception {
		StringBuffer buffer = new StringBuffer();
		List<String> args = new ArrayList<String>();
		buffer.append("select t.user_id,t.mobile_no,t2.sign_channel from t_stkkh_cust_info t ,t_stkkh_origin_record t2  where t.user_id=t2.user_id and t.mobile_no=?");
		 args.add(mobile_no);
	  return this.getJdbcTemplateWork().queryMap(buffer.toString(),args.toArray());
	}
	

	/**
	 * 作者：MIKE
	 * 公司：深圳市思迪信息技术股份公司
	 * 日期时间：2017年12月19日 下午3:01:29
	 * 说明：区域数据信息
	 */
	public List<DataRow> getRegionList() throws Exception {
		String sql ="SELECT REGION.REGION_ID,REGION.REGION_NAME FROM T_PUB_REGION  REGION WHERE REGION.STATE=1 ";
		return this.getJdbcTemplateWork().query(sql);
	}
}
