package com.thinkive.fxc.ismp.bus.base.business.dao.impl;

import java.util.Date;

import com.thinkive.base.jdbc.session.Session;
import com.thinkive.fxc.ismp.bus.base.business.constants.BusinessTableConstants;
import com.thinkive.fxc.ismp.bus.base.business.dao.AuditTaskInfoDao;
import com.thinkive.fxc.ismp.bus.base.business.model.AuditTaskInfoModel;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.constants.SystemConstants;

/**
 * 描述: 审核任务DAO实现类
 * 版权: Copyright (c) 2010
 * 公司: 思迪科技 
 * 作者: 刘恺
 * 版本: 1.0 
 * 创建日期: 2016年6月28日 
 * 创建时间: 下午5:53:26
 */
public class AuditTaskInfoDaoImpl extends ISMPBaseDao implements AuditTaskInfoDao
{
	
	@Override
	public AuditTaskInfoModel addTask(AuditTaskInfoModel auditTaskInfo)
	{
		auditTaskInfo.setId(Long.parseLong(getSeqValue(SystemConstants.DB_ISMP,BusinessTableConstants.T_FXC_AUDIT_BOUND)));
		auditTaskInfo.setCreateDate(new Date());
		if(BusinessTableConstants.T_FXC_AUDIT_BOUND.equals("T_ISMP_AUDIT_BOUND")){//这里特殊处理老表字段与新表字段名不一致
			String state = auditTaskInfo.getState();
			auditTaskInfo.setAuditAccount(state);
			auditTaskInfo.remove("state");
		}
		getJdbcTemplate().insert(BusinessTableConstants.T_FXC_AUDIT_BOUND, auditTaskInfo);
		return auditTaskInfo;
	}
	
	@Override
	public AuditTaskInfoModel addTask(AuditTaskInfoModel auditTaskInfo,Session session)throws Exception
	{
		auditTaskInfo.setId(Long.parseLong(getSeqValue(SystemConstants.DB_ISMP,BusinessTableConstants.T_FXC_AUDIT_BOUND)));
		auditTaskInfo.setCreateDate(new Date());
		if(BusinessTableConstants.T_FXC_AUDIT_BOUND.equals("T_ISMP_AUDIT_BOUND")){//这里特殊处理老表字段与新表字段名不一致
			String state = auditTaskInfo.getState();
			auditTaskInfo.setAuditState("");
			auditTaskInfo.remove("state");
		}
		session.insert(BusinessTableConstants.T_FXC_AUDIT_BOUND, auditTaskInfo);
		return auditTaskInfo;
	}
	
}
