package com.thinkive.fxc.ismp.bus.base.basicdata.dao.impl;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.apache.commons.lang.StringUtils;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.basicdata.contants.BaseTableConstants;
import com.thinkive.fxc.ismp.bus.base.basicdata.dao.CityDao;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.CityModel;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.constants.SystemConstants;
import com.thinkive.fxc.ismp.bus.base.util.ModelUtil;

/**
 * @描述: 公共-城市信息表(公共-城市信息表)数据层接口实现类
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 田源
 * @版本: 2.0.0 
 * @创建时间: 2016年8月18日 下午3:10:16
 */
public class CityDaoImpl extends ISMPBaseDao implements CityDao
{

    @Override
    public CityModel add(CityModel cityModel) throws Exception
    {
        String id=getSeqValue(SystemConstants.DB_ISMP,BaseTableConstants.T_FXC_CITY);
        cityModel.setId(Long.valueOf(id));
        cityModel.setCreateDate(new Date());
        this.getJdbcTemplate().insert(BaseTableConstants.T_FXC_CITY, cityModel);
        return cityModel;
    }

    @Override
    public int update(CityModel cityModel) throws Exception
    {
        cityModel.setUpdateDate(new Date());
        return this.getJdbcTemplate().update(BaseTableConstants.T_FXC_CITY, cityModel, "ID", cityModel.getId());
    }

    @Override
    public CityModel queryById(Long id) throws Exception
    {
        StringBuilder sql=new StringBuilder();
        sql.append("SELECT ID,REGION_ID,CITY_NAME,PROVINCE_NO,ORDER_NUM,IS_DISPLAY FROM ");
        sql.append(BaseTableConstants.T_FXC_CITY);
        sql.append(" WHERE ID = ?");
        DataRow dataRow=this.getJdbcTemplate().queryMap(sql.toString(),new Object[]{id});
        return ModelUtil.packInfo(dataRow, CityModel.class);
    }

    @Override
    @SuppressWarnings("unchecked")
    public List<CityModel> queryByParams(CityModel cityModel) throws Exception
    {
        StringBuilder sql=new StringBuilder();
        List<String> paramsList=new ArrayList<String>();
        sql.append("SELECT ID,REGION_ID,CITY_NAME,PROVINCE_NO,ORDER_NUM,IS_DISPLAY FROM ");
        sql.append(BaseTableConstants.T_FXC_CITY);
        sql.append(" WHERE 1 = 1");
        if(null != cityModel.getRegionId()){
            sql.append(" AND REGION_ID = ?");
            paramsList.add(cityModel.getRegionId().toString());
        }
        if(null != cityModel.getProvinceNo()){
            sql.append(" AND PROVINCE_NO = ?");
            paramsList.add(cityModel.getProvinceNo().toString());
        }
        if(StringUtils.isNotBlank(cityModel.getCityName())){
            sql.append(" AND CITY_NAME = ?");
            paramsList.add(cityModel.getCityName());
        }
        if(null != cityModel.getIsDisplay()){
            sql.append(" AND IS_DISPLAY = ?");
            paramsList.add(cityModel.getIsDisplay().toString());
        }
        List<DataRow> dataList=this.getJdbcTemplate().query(sql.toString(), paramsList.toArray());
        return ModelUtil.packList(dataList, CityModel.class);
    }
    
}
