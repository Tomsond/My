package com.thinkive.fxc.ismp.bus.business.smjj.function;

import java.util.List;

import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseFunction;
import com.thinkive.fxc.ismp.bus.base.constants.DictionaryConstants;
import com.thinkive.fxc.ismp.bus.base.constants.ErrorCodeCheckInput;
import com.thinkive.fxc.ismp.bus.business.smjj.constants.SmjjConstants;
import com.thinkive.fxc.ismp.bus.business.smjj.model.SmjjAssetsRecordModel;
import com.thinkive.fxc.ismp.bus.business.smjj.service.SmjjImageRecordService;
import com.thinkive.server.InvokeException;
import com.thinkive.server.ResultVo;
import com.thinkive.server.util.SpringUtil;

/**
 * 
 * @描述: 查询私募认证投资者内部条件检查情况
 * @版权: Copyright (c) 2019 
 * @公司: 思迪信息 
 * @作者: 闫耀辉
 * @版本: V3.0.0
 * @创建日期: 2019年9月18日 
 * @创建时间: 下午3:12:18
 */
public class Function3100021 extends ISMPBaseFunction
{

    @Override
    public ResultVo execute() throws InvokeException, Exception
    {
       String businessId = this.getAndCheckBlankStrParam("businessId",ErrorCodeCheckInput.BLANK_BUSINESSID); // 业务ID不能为空
       String userId = this.getAndCheckBlankStrParam("userId",ErrorCodeCheckInput.BLANK_USERID); // 用户编号不能为空
       
       SmjjImageRecordService imageRecordService = SpringUtil.getBean(SmjjConstants.SERVICE_ID_SMJJIMAGERECORD,
               SmjjImageRecordService.class);
       SmjjAssetsRecordModel smjjAssetsRecordModel = new SmjjAssetsRecordModel();
       smjjAssetsRecordModel.setBusinessId(Long.parseLong(businessId));
       smjjAssetsRecordModel.setUserId(Long.parseLong(userId));
       List<SmjjAssetsRecordModel> list = imageRecordService.queryAssetRecord(smjjAssetsRecordModel);
       ResultVo returnResult = new ResultVo();
       if(list != null && list.size() > 0) {
           // 此处应该只能查出一条记录
           returnResult.setResult(list.get(0));
       }
       returnResult.setErrorNo(DictionaryConstants.INVOKE_FUNCTION_SUCCESS);
       returnResult.setErrorMsg(DictionaryConstants.INVOKE_FUNCTION_SUCCESSMSG);
       return returnResult;
    }
}
