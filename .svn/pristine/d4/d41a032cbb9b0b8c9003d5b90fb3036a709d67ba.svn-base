package com.thinkive.fxc.ismp.bus.base.basicdata.dao.impl;

import java.util.Date;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.basicdata.contants.BaseTableConstants;
import com.thinkive.fxc.ismp.bus.base.basicdata.dao.IdnoInfoDao;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.IdNoInfoModel;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.constants.SystemConstants;
import com.thinkive.fxc.ismp.bus.base.util.ModelUtil;

/**
 * @描述: 公共-公安校验信息存放表(T_FXC_IDNO_INFO)数据层接口实现类
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 田源
 * @版本: 2.0.0 
 * @创建时间: 2016年8月19日 下午5:14:51
 */
public class IdnoInfoDaoImpl extends ISMPBaseDao implements IdnoInfoDao
{

    @Override
    public IdNoInfoModel add(IdNoInfoModel idNoInfoModel) throws Exception
    {
        String id=getSeqValue(SystemConstants.DB_ISMP,BaseTableConstants.T_FXC_IDNO_INFO);
        idNoInfoModel.setId(Long.valueOf(id));
        idNoInfoModel.setCreateDate(new Date());
        this.getJdbcTemplate().insert(BaseTableConstants.T_FXC_IDNO_INFO, idNoInfoModel);
        return idNoInfoModel;
    }

    @Override
    public int update(IdNoInfoModel idNoInfoModel) throws Exception
    {
        idNoInfoModel.setUpdateDate(new Date());
        return this.getJdbcTemplate().update(BaseTableConstants.T_FXC_IDNO_INFO, idNoInfoModel, "ID", idNoInfoModel.getId());
    }

    @Override
    public IdNoInfoModel queryByCitizenIdNumber(String citizenIdNumber) throws Exception
    {
        StringBuilder sql=new StringBuilder();
        sql.append("SELECT ID,BIRTH_DATE,CITIZEN_ID_NUMBER,NAME,PHOTOS,SEXCODE,PHOTO_PATH,SOURCE,SECRET_KEY FROM ");
        sql.append(BaseTableConstants.T_FXC_IDNO_INFO);
        sql.append(" WHERE CITIZEN_ID_NUMBER = ?");
        DataRow dataRow=this.getJdbcTemplate().queryMap(sql.toString(), new Object[]{citizenIdNumber});
        return ModelUtil.packInfo(dataRow, IdNoInfoModel.class);
    }
    
}
