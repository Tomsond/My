package com.thinkive.fxc.ismp.bus.business.rzrq.preMarginTrading.dao.impl;

import java.util.Date;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.base.util.DateHelper;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;
import com.thinkive.fxc.ismp.bus.base.constants.SystemConstants;
import com.thinkive.fxc.ismp.bus.base.util.ModelUtil;
import com.thinkive.fxc.ismp.bus.business.rzrq.preMarginTrading.constant.PreMarginTradingConstants;
import com.thinkive.fxc.ismp.bus.business.rzrq.preMarginTrading.dao.AdditionalInfoDao;
import com.thinkive.fxc.ismp.bus.business.rzrq.preMarginTrading.model.AdditionalInfo;

/**
 * @描述: 融资融券用户补充信息表数据层服务实现类（T_ISMP_B_PREMARGIN_ADDITIONAL）
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 刘恺
 * @版本: 2.0.0 
 * @创建时间: 2016年8月31日 上午9:58:34
 */
public class AdditionalInfoDaoImpl extends ISMPBaseDao implements AdditionalInfoDao
{
	
	public AdditionalInfo addAdditionalInfo(AdditionalInfo userAddiInfo)
	{
		String id = getSeqValue(SystemConstants.DB_ISMP,PreMarginTradingConstants.TAB_PRERZRQADD);
		userAddiInfo.setId(id);
		String nowDate = DateHelper.formatDate(new Date(), DateHelper.pattern_time);
		userAddiInfo.setCreateDate(nowDate);
		userAddiInfo.setUpdateDate(nowDate);
		getJdbcTemplate().insert(PreMarginTradingConstants.TAB_PRERZRQADD, userAddiInfo);
		return userAddiInfo;
	}
	
	public AdditionalInfo updateAdditionalInfoById(AdditionalInfo userAddiInfo)
	{
		String id = userAddiInfo.getId();
		String nowDate = DateHelper.formatDate(new Date(), DateHelper.pattern_time);
		userAddiInfo.setUpdateDate(nowDate);
		getJdbcTemplate().update(PreMarginTradingConstants.TAB_PRERZRQADD, userAddiInfo, "ID", id);
		userAddiInfo.setId(id);
		return userAddiInfo;
	}
	
	public AdditionalInfo getIdByBIdAndQueId(Long businessId) throws Exception
	{
		StringBuilder sql = new StringBuilder("SELECT ID FROM ");
		sql.append(PreMarginTradingConstants.TAB_PRERZRQADD).append(" WHERE BUSINESS_ID = ?");
		DataRow queryResult = getJdbcTemplate().queryMap(sql.toString(), new Object[] { businessId });
		return ModelUtil.packInfo(queryResult, AdditionalInfo.class);
	}
}
