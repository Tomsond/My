package com.thinkive.fxc.ismp.bus.base.business.function;

import java.util.List;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.base.util.SpringHelper;
import com.thinkive.base.util.StringHelper;
import com.thinkive.fxc.ismp.bus.base.basicdata.service.ProvinceCityService;
import com.thinkive.fxc.ismp.bus.base.business.constants.BusinessServiceBeanIdConstants;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseFunction;
import com.thinkive.fxc.ismp.bus.base.constants.DictionaryConstants;
import com.thinkive.server.ResultVo;


/**
 * 作者：MIKE
 * 公司：深圳市思迪信息技术股份公司
 * 日期时间：2017年1月6日 上午11:19:48
 * 说明：查询省、市数据
 */
public class Function1004929 extends ISMPBaseFunction
{
	private String regional_id; //区域编号
	private String province_no; //省份编号
	private String city_no; //城市编号
	private String type;//类型
	private ProvinceCityService provincecityservice ; 
	@Override
	public ResultVo execute() throws Exception
	{
		initVar();
		ResultVo resultVo = new ResultVo();
		provincecityservice = SpringHelper.getBean(BusinessServiceBeanIdConstants.SERVICE_ID_PROVINCE_NO, ProvinceCityService.class);
		List<DataRow> provincecity=null;
		List<DataRow> regionidlist=null;
		if(type.equals("0")){
			if(!StringHelper.isNotEmpty(province_no)&&!StringHelper.isNotEmpty(city_no)&&!StringHelper.isNotEmpty(regional_id)){//省份编号与城市编号都为空则查询省份信息
				provincecity = provincecityservice.getProvinceList();
			}else if(StringHelper.isNotEmpty(province_no)&&!StringHelper.isNotEmpty(city_no)&&!StringHelper.isNotEmpty(regional_id)){//省份编号不为空则查询城市信息
				provincecity = provincecityservice.getCityList(province_no);
			}else if(!StringHelper.isNotEmpty(province_no)&&!StringHelper.isNotEmpty(city_no)&&StringHelper.isNotEmpty(regional_id)){//区域编号不为空则查询区域下城市、省份信息
				provincecity = provincecityservice.getPostList(regional_id);
				regionidlist = provincecityservice.getRegionIdList(regional_id);
			}
	   }else{
		   provincecity = provincecityservice.getRegionList();//区域数据信息
	   }
		resultVo.setErrorNo(DictionaryConstants.INVOKE_FUNCTION_SUCCESS);
		resultVo.setErrorMsg(DictionaryConstants.INVOKE_FUNCTION_SUCCESSMSG);
		resultVo.setResult("regionidlist",regionidlist);
		resultVo.setResult(provincecity);
		return resultVo;
	}
	
	/**
	 * @描述：初始化入参
	 * @作者：刘恺
	 * @时间：2016年9月9日 下午2:08:07
	 */
	private void initVar()
	{
		type = this.getStrParameter("type","0");
		province_no = this.getStrParameter("province_no");
		city_no = this.getStrParameter("city_no");
	}
}
