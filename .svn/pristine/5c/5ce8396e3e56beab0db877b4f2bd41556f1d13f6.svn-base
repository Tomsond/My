package com.thinkive.fxc.ismp.bus.base.basicdata.dao.impl;

import java.util.Date;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.basicdata.dao.AnswerScoreDao;
import com.thinkive.fxc.ismp.bus.base.basicdata.model.AnswerScoreModel;
import com.thinkive.fxc.ismp.bus.base.business.constants.BusinessTableConstants;
import com.thinkive.fxc.ismp.bus.base.common.ISMPBaseDao;

public class AnswerScoreDaoImpl extends ISMPBaseDao implements AnswerScoreDao{

	@Override
	public void addOrUpdateAnswerScore(AnswerScoreModel answerScoreModle) {
		String business_id = answerScoreModle.getBusinessId();
		String node_id = answerScoreModle.getNodeId();
		Date date = new Date();
		answerScoreModle.setUpdateDate(date);
		DataRow answerScore = this.queryAnswerScoreByBusinessId(business_id, node_id);
		if(answerScore == null){
			String id = getSeqValue(BusinessTableConstants.T_ISMP_HJ_SCORE);
			answerScoreModle.setId(id);
			answerScoreModle.setCreateDate(date);
			this.getJdbcTemplate().insert(BusinessTableConstants.T_ISMP_HJ_SCORE, answerScoreModle);
			return ;
		}
		answerScoreModle.setId(answerScore.getString("id"));
		this.getJdbcTemplate().update(BusinessTableConstants.T_ISMP_HJ_SCORE, answerScoreModle, "ID", answerScoreModle.getId());
	}

	@Override
	public DataRow queryAnswerScoreByBusinessId(String business_id, String node_id) {
		return this.getJdbcTemplate().queryMap("select * from " + BusinessTableConstants.T_ISMP_HJ_SCORE + " where business_id = ? and node_id = ? ", new Object[]{business_id, node_id});
	}

}
