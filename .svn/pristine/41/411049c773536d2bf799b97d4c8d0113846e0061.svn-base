package com.thinkive.fxc.ismp.bus.base.business.service;

import java.util.List;
import java.util.Map;

import com.thinkive.base.jdbc.DataRow;
import com.thinkive.fxc.ismp.bus.base.business.model.AgreeRecordModel;

/**
 * @描述: 签名验签服务类
 * @版权: Copyright (c) 2010
 * @公司: 深圳市思迪信息技术股份有限公司
 * @作者: 刘恺
 * @版本: 2.0.0 
 * @创建时间: 2017年2月20日 下午12:13:02
 */
public interface SignAndVerifyService
{
	
	/**
	 * @描述：验签
	 * @作者：刘恺
	 * @时间：2017年2月20日 下午12:11:16
	 * @param sign_source_flag
	 * @param signList
	 * @param certuid
	 * @param cert_type
	 * @param checksign
	 * @return
	 * @throws Exception
	 */
	@SuppressWarnings("rawtypes")
	public abstract List<DataRow> verify(String sign_source_flag, List signList, String certuid, String cert_type, String checksign) throws Exception;
	
	/**
	 * @描述：批量验签
	 * @作者：刘恺
	 * @时间：2017年2月20日 下午12:11:20
	 * @param signSourceFlag
	 * @param signList
	 * @param certuid
	 * @param certType
	 * @param checkSign
	 * @return
	 * @throws Exception
	 */
	@SuppressWarnings("rawtypes")
	public abstract List<DataRow> verifyBatch(String signSourceFlag, List signList, String certuid, String certType, String checkSign) throws Exception;
	
	/**
	 * @描述：单个验签
	 * @作者：刘恺
	 * @时间：2017年2月20日 下午12:11:22
	 * @param signSourceFlag
	 * @param signList
	 * @param certuid
	 * @param certType
	 * @param checkSign
	 * @return
	 * @throws Exception
	 */
	@SuppressWarnings("rawtypes")
	public abstract List<DataRow> verifySingle(String signSourceFlag, List signList, String certuid, String certType, String checkSign) throws Exception;
	
	/**
	 * @描述：调用证书bus接口，查询证书信息
	 * @作者：刘恺
	 * @时间：2016年9月2日 下午3:35:27
	 * @param cert_type
	 * @param certuid
	 * @return
	 */
	public abstract String queryCert(String cert_type, String certuid);
	
	/**
	 * @描述：使用托管证书签名
	 * @作者：刘恺
	 * @时间：2017年2月20日 下午12:11:38
	 * @param textList
	 * @param cert_type
	 * @param userInfo
	 * @param ipaddr
	 * @param macaddr
	 * @param password
	 * @return
	 * @throws Exception
	 */
	public abstract DataRow signByTg(String textList, String cert_type, DataRow userInfo, String ipaddr, String macaddr, String password) throws Exception;
	
	/**
	 * @描述：验签
	 * @作者：刘恺
	 * @时间：2017年2月20日 下午12:11:46
	 * @param userId
	 * @param jsondata
	 * @param signType
	 * @param signSourceFlag
	 * @return
	 * @throws Exception
	 */
	public abstract List<DataRow> verifySignText(Long userId, String jsondata, String signType, String signSourceFlag) throws Exception;
	
	/**
	 * @描述：验签
	 * @作者：刘恺
	 * @时间：2016年9月1日 下午4:11:38
	 * @param userId
	 * @param jsondata		协议json
	 * @param signParamsMap	节点属性
	 * @throws Exception
	 */
	public abstract Map<String, List<Map<String, String>>> verifySignText(String jsondata, Map<String, DataRow> signParamsMap) throws Exception;
	
	/**
	 * @描述：讲验签后的协议数据打包为协议model
	 * @作者：刘恺
	 * @时间：2016年9月2日 下午3:49:07
	 * @param allSignList
	 * @param businessId
	 * @param nodeId
	 * @return
	 * @throws Exception
	 */
	public abstract List<AgreeRecordModel> getAgreeRecordModels(Long userId, List<Map<String, String>> allSignList, Long businessId, String nodeId,String checksign) throws Exception;
	
	/**
	 * @描述：验签，并在验签成功后保存协议信息
	 * @作者：刘恺
	 * @时间：2016年9月2日 下午4:39:32
	 * @param userId
	 * @param businessId
	 * @param nodeId
	 * @param jsondata
	 * @param signParamsMap
	 * @return
	 * @throws Exception
	 */
	public abstract List<AgreeRecordModel> verifyAndSave(Long userId, Long businessId, String nodeId, String jsondata, Map<String, DataRow> signParamsMap) throws Exception;
	
	/**
	 * @描述：验签，如果需要提交第三方则直接提交
	 * @作者：刘恺
	 * @时间：2016年9月13日 下午4:31:24
	 * @param jsondata
	 * @param signParamsMap
	 * @return
	 * @throws Exception
	 */
	public abstract List<Map<String, String>> verifySignTextAndSubmitThird(String jsondata, Map<String, DataRow> signParamsMap) throws Exception;

	public abstract List<Map<String, String>> verifySignTextAndSubmitThird(String jsondata) throws Exception;

	
	public abstract List<Map<String, String>> verifySignTextAndSubmitThirdSpecial(String jsondata, Map<String, DataRow> signParamsMap) throws Exception;

	public abstract Map<String, List<Map<String, String>>> verifySignTextSpecial(String jsondata, Map<String, DataRow> signParamsMap) throws Exception;

    public abstract List<AgreeRecordModel> signContract(long userId, String jsondata) throws Exception;
    
    /**
     * @描述: 验签，如果需要提交第三方则直接提交（不校验是否全部提交）
     * @作者: 农仕冰
     * @时间: 2019年8月13日 上午10:52:05
     * @param jsondata
     * @param signParamsMap
     * @return
     * @throws Exception
     */
    public abstract List<Map<String, String>> verifySignTextAndSubmitThirdNew(String jsondata, Map<String, DataRow> signParamsMap) throws Exception;
}